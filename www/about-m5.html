<html>
<head>
<title>About ICANN’s ITHI Metric M5</title>

<link rel="stylesheet" type="text/css" href="ithistyle.css">

<script src="ithinav.js"></script>
<script type="text/javascript">
    function init() {<t
        initnav();
    }
</script>
</head>

<body onload="init()">
<nav id="navMenu"></nav>
<h1>ITHI M5: DNS Recursive Resolver Integrity</h1>
<p>
The M5 metrics measure the "integrity" with which resolvers process queries. 
There are five components in the M5 metric:
</p>
<ul>
<li>The metric M5.1 measures the % of visible recursive resolvers that refresh their local cache in accordance with the time specified in the SOA TTL, and the effect on users. For each population, we compute the fraction of users or resolvers that re-fetch erlier than the stated TTL, and the fraction that re-fetch according to the TTL. These two numbers do not add to 100%, because there is also a fraction of resolvers for which our measurements are inconclusive.
<li>The metric M5.2 measure the % of visible recursive resolvers that refresh their local cache automatically (without a triggering user query), as well as the estimated query load % due to automated cache refresh and the % of users using resolvers that auto-refresh their cache.
<li>The Metric M5.3 measures the % of visible recursive resolvers that set the DO (DNSSEC OK) bit in their queries, as well as the fraction of users using resolvers that set the DO bit in queries.
<li>The Metric M54 measures the % of visible recursive resolvers that perform DNSSEC validation of responses, as well as the fraction of users using resolvers that perform DNSSEC validation of responses.
<li>The metric M5 provide a distribution of the estimated client size of the 10,000 largest visible recursive resolvers.
</ul>
<p>
The M5 metric is computed by APNIC. The process involves buying Google ads to generate a large number
of "impressions" every day. The count varies from day to day, as explained <a href="https://stats.labs.apnic.net/about/">
here</a>. Each ad runs a script that causes a script to be run, which resolves DNS names and loads web pages under APNIC
control. The URL of the web page is personalized, enabling APNIC to correlate the traffic seen at the DNS resolver
and web server with the script run at the client. The source address of the DNS queries received by APNIC
identifies the resolver. The country in which the client is located is deduced for the source IP address
of the web requests, using an IP address geolocation database.
</p>
<p>
The statistics provide tabulation "per user" and "per resolver". The tabulation per resolver is straightforward,
as each resolver can be identified by its IP address. The computation per user would be straightforward if
the Google Ads were a randomized sampling of all Internet users, but that's not the case. Ad distribution is affected
by a number of factor, resulting in oversampling of some countries, and undersampling of some others. 
APNIC compensate against by computing the number of impression per country, based on the IP addresses of
the clients, and then computing a "per country" weight defined as the ratio of the number of Internet users
in the country divided by the number of impressions in that country.
</p>
<p>
The web pages used by the script generate a different URL for each user, with a unique domain name and 
a known TTL. APNIC can observe DNS requests trying to "refresh the cache" for these domain names, and can infer
from there the cache refresh strategies used by the resolvers.
</p>
<p>
The complete list of M5 metrics is listed in the following table:
</p>

<table class="metrics" >
<tr>
   <th colspan=2>M5.1 (% alignment of cache time to SOA TTL)</th>
</tr>
<tr>

   <td class="number">
   M5.1.1
   </td>
   <td>
   % of users using resolvers that re-fetch early
   </td>
</tr>
<tr>
   <td class="number">
   M5.1.2
   </td>
   <td>
   % of users using resolvers that re-fetch according to TTL
   </td>
</tr>
<tr>
   <td class="number">
   M5.1.3
   </td>
   <td>
   % of users using indeterminate resolvers
   </td>
</tr>
<tr>
   <td class="number">
   M5.1.4
   </td>
   <td>
   % of resolvers that re-fetch early
   </td>
</tr>
<tr>
   <td class="number">
   M5.1.5
   </td>
   <td>
   % of resolvers that re-fetch according to TTL
   </td>
</tr>
<tr>
   <td class="number">
   M5.1.6
   </td>
   <td>
   % of resolvers where cache time is indeterminate
   </td>
</tr>
<tr></tr>
<tr>
   <th colspan=2>
   M5.2 (% auto cache refresh)
   </th>
</tr>
        <tr>
            <td class="number">
                M5.2.1
            </td>
            <td>
                % of users using resolvers that auto-refresh their cache
            </td>
        </tr>

        <tr>
            <td class="number">
                M5.2.2
            </td>
            <td>
                % of query load due to cache refresh
            </td>
        </tr>

        <tr>
            <td class="number">
                M5.2.3
            </td>
            <td>
                % of resolvers that auto-refresh their cache
            </td>
        </tr>
<tr>
   <th colspan=2>
   M5.3 (% EDNS0 DO query rate)
   </th>
</tr>

        <tr>
            <td class="number">
                M5.3.1
            </td>
            <td>
                % of users using resolvers that set the DO bit in queries
            </td>
        </tr>

        <tr>
            <td class="number">
                M5.3.2
            </td>
            <td>
                % of resolvers that set the DO bit in queries
            </td>
        </tr>
<tr></tr>
<tr>
   <th colspan=2>
   M5.4 (%DNSSEC Validation rate)
   </th>
</tr>

        <tr>
            <td class="number">
                M5.4.1
            </td>
            <td>
                % of users using resolvers that perform DNSSEC validation
            </td>
        </tr>

        <tr>
            <td class="number">
                M5.4.2
            </td>
            <td>
                % of resolvers that perform DNSSEC validation
            </td>
        </tr>
<tr></tr>
<tr>
   <th colspan=2>
   M5.5 (Distribution of resolver use)
   </th>
</tr>

        <tr>
            <td class="number">
                M5.5
            </td>
            <td>
                % of users using one of the top 10,000 resolvers
            </td>
        </tr>

    </table>

<p>
The current values of the metrics is available <a href="graph-m5.html">here</a>.
</p>
</body>
</html>