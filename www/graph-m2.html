<html>
<head>
    <style>
        html {
            font-family: Verdana;
        }

        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }
    </style>

    
	
<script type="text/javascript">

var canvas ;
var context ;
var Val_max;
var Val_min;
var sections;
var xScale;
    var yScale;

    // Values for the M3.1 and M3.2 metrics, since Jan 2017 -- this is test data
    
    var M2Data = [
        [2.46, 4.065, 2.295, 2.69, 2.69, 5.63, 2.41, 2.23, 2.5],
        [3.645, 3.67, 2.88, 2.775, 4.48, 4.6, 3.1, 2.81, 2.74],
        [104.845, 95.22, 98.435, 95.15, 109.88, 104.86, 109.55, 99.81, 85.58],
        [2.095, 2.285, 3.03, 3.065, 1.07, 2.16, 3.45, 3.12, 2.41]];

    var M2DataMax = [5, 200, 5, 5];

    function init() {

        // Set the text values that depend on the current data
        setDateElement("September 2017");
        setValElement("valM21", getLastElement(M2Data[0]));
        setValElement("valM22", getLastElement(M2Data[1]));
        setValElement("valM23", getLastElement(M2Data[2]));
        setValElement("valM24", getLastElement(M2Data[3]));
        setValElement("averageM21", getAverageElement(M2Data[0]));
        setValElement("averageM22", getAverageElement(M2Data[1]));
        setValElement("averageM23", getAverageElement(M2Data[2]));
        setValElement("averageM24", getAverageElement(M2Data[3]));

        // Draw the relevant graphs
        plotGraphM2("graphM21", M2Data[0], 10, "#404040C0");
        plotGraphM2("graphM22", M2Data[1], 10, "#404040C0");
        plotGraphM2("graphM23", M2Data[2], 200, "#404040C0");
        plotGraphM2("graphM24", M2Data[3], 10, "#404040C0");    
    }

    function setDateElement(dateValue)
    {
        dateElement = document.getElementById("dateHeading");
        dateElement.innerHTML = dateValue;
    }

    function setValElement(valElementId, x) {
        elm = document.getElementById(valElementId);
        if (x.toFixed(2)) {
            elm.innerHTML = "<b>" + x.toFixed(2) + "</b>";
        }
        else {
            elm.innerHTML = "<b>" + x + "</b>";
        }
    }

    function getLastElement(dataSet)
    {
        if (dataSet.length < 1) {
            return "-";
        }
        else
        {
            return dataSet[dataSet.length - 1];
        }
    }

    function getAverageElement(dataSet)
    {
        if (dataSet.length <= 1)
        {
            return "-";
        }
        else
        {
            last = dataSet.length - 2;
            first = 0;
            if (dataSet.length > 13)
            {
                first = dataSet.length - 13;
            }
            average = 0;
            for (i = first; i <= last; i++)
            {
                average += dataSet[i];
            }
            average /= (last + 1 - first);

            return average;
        }
    }

function setScale(canvasId, v_max)
{
	sections = 12;
	Val_max = v_max;
	Val_min = 0;
    var stepSize = v_max / 10;
	var columnSize = 50;
	var rowSize = 50;
	var margin = 10;
	var xAxis = [" ", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] 
			
	canvas = document.getElementById(canvasId);
	context = canvas.getContext("2d");
	context.fillStyle = "#808080"
	context.font = "20 pt Verdana"
	
	yScale = (canvas.height - columnSize - margin) / (Val_max - Val_min);
	xScale = (canvas.width - rowSize) / sections;
	
	context.strokeStyle="#808080"; // color of grid lines
	context.beginPath();
		// print Parameters on X axis, and grid lines on the graph
	for (i=1;i<=sections + 1;i++) {
		var x = i * xScale;
		context.fillText(xAxis[i], x,columnSize - margin);
		context.moveTo(x, columnSize + margin);
		context.lineTo(x, canvas.height);
	}
		// print row header and draw horizontal grid lines
	var count =  0;
	for (scale=Val_max;scale>=Val_min;scale = scale - stepSize) {
		var y = columnSize + (yScale * count * stepSize); 
		context.fillText(scale, margin,y + margin);
		context.moveTo(rowSize,y + margin)
		context.lineTo(canvas.width,y + margin)
		count++;
	}
	context.stroke();
	
	context.translate(rowSize,canvas.height + Val_min * yScale);
	context.scale(1,-1 * yScale);
}

    function plotGraphM2(canvasId, dataSet, valmax, graphColor) {

        setScale(canvasId, valmax);


    l = dataSet.length; 
    if (l > sections)
    {
        l = sections;
    }

    context.fillStyle = graphColor;
    context.beginPath();
    context.moveTo(0, 0);

    for (i=0; i<l; i++) {
        context.lineTo(i * xScale, dataSet[i]);
    }

    context.lineTo((l-1) * xScale, 0);
    context.closePath();
    context.fill();
}

</script>
</head>

<body onLoad="init()">

<h1>M2: Domain Name Abuses</h1>

<h2 id="dateHeading">-</h2>

    <p>
        The domain name abuses are tracked by measuring the number of registered domain
        names used in four kinds of abuse: phishing, malware distribution, spam, and 
        command and control of botnets. M2 comprises 4 different sub metrics, 
        one for each type of abuse. The following table provides the value observed 
        for these metrics in the current month, as well as the average value over the
        12 months preceeding this one -- or the average since the beginning of 
        measurements if measurements started fewer than 12 months ago.
    </p>

<table>
    <tr>
        <th>M2 metric name</th>
        <th>Current value</th>
        <th>Average value</th>
    </tr>
    <tr>
        <td>
            <a href="#M21">
                M2.1 = number of Phishing Domains per 10000 registered domain names
            </a>
        </td>
        <td align="right" id="valM21">
            -
        </td>
        <td align="right" id="averageM21">
            -
        </td>
    </tr>
    <tr>
        <td>
            <a href="#M22">
                M2.2 = number of Malware Domains per 10,000 registered domain names
             </a>
        </td>
        <td align="right" id="valM22">
            -
        </td>
        <td align="right" id="averageM22">
            -
        </td>
    </tr>
    <tr>
        <td>
            <a href="#M21">
                M2.3 = number of Spam Domains per 10,000 registered domain names
            </a>
        </td>
        <td align="right" id="valM23">
            -
        </td>
        <td align="right" id="averageM23">
            -
        </td>
    </tr>
    <tr>
        <td>
            <a href="#M24">
                M2.4 = number of Botnet C&C Domains per 10,000 registered domain names
            </a>
        </td>
        <td align="right" id="valM24">
            -
        </td>
        <td align="right" id="averageM24">
            -
        </td>
    </tr>
</table>
    <p>
        The following graphs show the evolution over time of these 4 metrics. 
        Please pay attention to the scale, as the number of spam domains is much
        larger than the number of domains used in the other forms of malware.
    </p>

    <h3 id="M21">M2.1 = number of Phishing Domains per 10000 registered domain names</h3>
    <p>
        The following graph shows the evolution of the phishing domain metric M2.1 over time:
    </p>

    <canvas id="graphM21" height="400" width="650"></canvas>


    <h3 id="M22">M2.2 = number of Malware Domains per 10,000 registered domain names</h3>
    <p>
        The following graph shows the evolution of the malware domain metric M2.2 over time:
    </p>

    <canvas id="graphM22" height="400" width="650"></canvas>


    <h3 id="M23">M2.3 = number of Spam Domains per 10,000 registered domain names</h3>
    <p>
        The following graph shows the evolution of the spam domain metric M2.3 over time:
    </p>

    <canvas id="graphM23" height="400" width="650"></canvas>


    <h3 id="M24">M2.4 = number of Botnet C&C Domains per 10,000 registered domain names</h3>
    <p>
        The following graph shows the evolution of the botnet C&C metric M2.4 over time:
    </p>

    <canvas id="graphM24" height="400" width="650"> - </canvas>

</body>
</html>